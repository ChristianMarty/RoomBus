<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>RoomBus</title>
    <link media="print" />
    <link rel="stylesheet" href="https://www.christian-marty.ch/WebPaperLayout/documentTemplate_A4.css">
    <link rel="stylesheet" href="https://www.christian-marty.ch/WebPaperLayout/pageLayout.css">
    <link rel="stylesheet" href="https://www.christian-marty.ch/WebPaperLayout/navigation.css">
    <link rel="stylesheet" href="global.css">
</head>

<script src="https://www.christian-marty.ch/WebPaperLayout/page.js"></script>
<script src="https://www.christian-marty.ch/WebPaperLayout/navigation.js"></script>

<body>
    
<div class="wpl_navigation">
</div>

<div class="main">
<document-page 
    title="MiniBus" 
    subtitle="System documentation" 
    footer="christian-marty.ch/MiniBus/documentation/index.html"
    link="https://www.christian-marty.ch/MiniBus/documentation/index.html"
>
    <h1>MiniBus</h1>
    <p>MiniBus is a CAN-FD based bus for room monitoring and control.</p>
            
    <h2>Key Features</h2>
    <ul>
        <li>CAN-FD based</li>
        <li>Multi-master</li>
        <li>Up to 125 devices per line</li>
    </ul>

    <h2>Motivation</h2>
    <p>MiniBus was originally developed as a platform for room control and monitoring applications.</p>

    <h2>Inspiration</h2>
    <p>MiniBus was partially inspired by KNX. However, MiniBus is not intended as a replacement for KNX.</p>

</document-page>

<document-page>
    <h2>Terminology</h2>
    <table>
        <tr>
            <th>MiniBus</th>
            <td>This whole project including the hardware and software layer.</td>
        </tr>
        <tr>
            <th>Kernel</th>
            <td>Part of the firmware that boots the system, handles communication and runs the application.</td>
        </tr>

        <tr>
            <th>Application</th>
            <td>The user application.</td>
        </tr>
    
        <tr>
            <th>Node</th>
            <td>One entity on the bus.</td>
        </tr>
        <tr>
            <th>Frame </th>
            <td>Unit of data on the data link layer.</td>
        </tr>
        <tr>
            <th>Packet</th>
            <td>Unit of data on the network layer.</td>
        </tr>
        <tr>
            <th>Message</th>
            <td>Unit of data on the application layer.</td>
        </tr>
    </table>
    <h3>Requirement Levels</h3>
    <p>Requirement levels are denoted in accordance with <a href="https://www.rfc-editor.org/rfc/rfc2119.html">RFC2119</a>.</p>
    
    <h3>Numbers Representation</h3>
    <p>Numbers are represented in decimal format. A complementary representation in a hexadecimal or binary form can be added next to the decimal representation. e.g. 85 (55h / 01010101b).</p>

    <h3>Datatypes</h3>
    <p>The following data types are used in this document.</p>
    <p>All multi-byte values are stored in little-endian (MSB first) order.</p>
    <table>
        <tr>
            <th>Name</th>
            <th>C equivalent</th>
            <th>Description</th>
            <th>Encoding</th>
        </tr>
        <tr>
            <td>Bool</td>
            <td>Bool</td>
            <td>True or False </td>
            <td>True -> 0x01, False -> 0x00</td>
        </tr>
        <tr>
            <td>String</td>
            <td>Char []</td>
            <td>ANSI String</td>
            <td>Hallo Welt &lt NULL &gt</td>
        </tr>
        <tr>
            <td>Byte</td>
            <td>Unsigned Char</td>
            <td>A unsigned 8 bit number</td>
            <td>&ltByte&gt</td>
        </tr>
        <tr>
            <td>Integer</td>
            <td>Unsigned Int</td>
            <td>A unsigned 16 bit number</td>
            <td>&ltH Byte&gt&ltL Byte&gt</td>
        </tr>
        <tr>
            <td>Long</td>
            <td>Unsigned Long</td>
            <td>A unsigned 32 bit number</td>
            <td>&ltMSB Byte&gt&lt2. Byte&gt&lt3. Byte&gt&ltLSB Byte&gt</td>
        </tr>
        <tr>
            <td>sByte</td>
            <td>Signed Char</td>
            <td>A signed 8 bit number</td>
            <td>&ltByte&gt</td>
        </tr>
        <tr>
            <td>sInteger</td>
            <td>Signed Int</td>
            <td>A signed 16 bit number</td>
            <td>&ltH Byte&gt&ltL Byte&gt</td>
        </tr>
        <tr>
            <td>sLong</td>
            <td>Signed Long</td>
            <td>A signed 32 bit number</td>
            <td>&ltMSB Byte&gt&lt2. Byte&gt&lt3. Byte&gt&ltLSB Byte&gt</td>
        </tr>
        <tr>
            <td>Number</td>
            <td>float</td>
            <td>A 32-Bit floating point number</td>
            <td>&ltMSB Byte&gt&lt2. Byte&gt&lt3. Byte&gt&ltLSB Byte&gt</td>
        </tr>
    </table>
</document-page>

<document-page>
    <h2>Hardware and Physical Layer</h2>

    <h3>Connectors and Pinout</h3>
    <p>MiniBus devices should use a 6P6C modular connector (commonly, but incorrectly, often referred to as RJ-12 connector).</p>
    <p>If using a 6P6C modular connector is not feasible in a particular application, a different connector may be used.</p>

    <h4>Pinout</h4>
    <p>In case the 6P6C modular connector is used, the following pinout must be used:</p>
    <img src="connector.png" width="30%">
    <table>
        <tr>
            <th>Pin</th>
            <th>Signal</th>
            <th>Description</th>
        </tr>
        <tr>
            <td>1</td>
            <td>V+</td>
            <td></td>
        </tr>
        <tr>
            <td>2</td>
            <td>V+</td>
            <td></td>
        </tr>
        <tr>
            <td>3</td>
            <td>Bus +</td>
            <td></td>
        </tr>
        <tr>
            <td>4</td>
            <td>Bus -</td>
            <td></td>
        </tr>
        <tr>
            <td>5</td>
            <td>GND</td>
            <td></td>
        </tr><tr>
            <td>6</td>
            <td>GND</td>
            <td></td>
        </tr>
    </table>

    <h4>Bus Power</h4>
    <p>In case the 6P6C modular connector is used, the following specification must be obeyed:</p>
    <p><b>Voltage:</b> 24V DC +/- 20%</p>
    <p><b>Maximum Current:</b> 1A per bus line, 100mA per node</p>
    
    <h3>Status LEDs</h3>
    <p>Every bus node should be equipped with 3 LEDs, colored red, green and blue. These can either be individual LEDs or one RGB-LED.</p>
    <ul>
        <li>Red: Data Received and processed</li>
        <li>Green: Data Transmit</li>
        <li>Blue: Administration Mode is enabled</li>
    </ul>

    <h2>Data Link Layer</h2>
    <p>MiniBus uses CAN-FD with a 29-bit identifier at a fixed baud rate of 500k-baud.</p>
</document-page>

<document-page>
    <h2>Network Layer</h2>

    <p>MiniBus implements a network protocol on top of the CAN-FD identifier.</p>
    <p>While the identifier is reserved for the network layer, the data part of the CAN-FD frame can be freely used by the application layer.</p>

    <h3>CAN-Identifier</h3>
    <table>
        <tr>
            <th>Bit</th>
            <th>28</th>
            <th>27</th>
            <th>26</th>
            <th>25</th>
            <th>24</th>
            <th>23</th>
            <th>22</th>
            <th>21</th>
            <th>20</th>
            <th>19</th>
            <th>18</th>
            <th>17</th>
            <th>16</th>
            <th>15</th>
            <th>14</th>
            <th>13</th>
            <th>12</th>
            <th>11</th>
            <th>10</th>
            <th>9</th>
            <th>8</th>
            <th>7</th>
            <th>6</th>
            <th>5</th>
            <th>4</th>
            <th>3</th>
            <th>2</th>
            <th>1</th>
            <th>0</th>
        </tr>
        <tr>
            <th>Data</th>
            <td colspan="2">Priority</td>
            <td colspan="7">Source Addresse</td>
            <td colspan="7">Destination Addresse</td>
            <td colspan="6">Protocol Id</td>
            <td colspan="3">Cmd</td>
            <td colspan="4">Length</td>
        </tr>
    </table> 

    <h4>Priority</h4>
    <p>The priority field defines the priority of a frame on the bus. As a result of the CAN-bus arbitration, a higher number will result in a lower priority.</p>


    <table>
        <tr>
          <th>Id</th>
          <th>Priority</th>
          <th>Description</th>
        </tr>
        <tr>
            <td>0</td>
            <td>Immediate</td>
            <td>Reserved for alerts. Should not be used by applications.</td>
        </tr> 
        <tr>
            <td>1</td>
            <td>High</td>
            <td>For low-latency communication.</td>
        </tr>
        <tr>
            <td>2</td>
            <td>Normal</td>
            <td>For normal communication.</td>
        </tr>
        <tr>
            <td>3</td>
            <td>Low</td>
            <td>For file transfer, firmware updates and background tasks.</td>
        </tr>
    </table> 


    <h4>Addressing</h4>
    <p>MiniBus supports an address range of 1 - 126.</p>
    <ul>
        <li>Address 0 (0h) is reserved as production default.</li>
        <li>Address 127 (7Fh) is reserved as broadcast address.</li>
        <li>A broadcast frame will be received and processed by all devices on the bus.</li>
        <li>A unicast frame must only be processed by the addressed node.</li>
    </ul>

    <h4>Protocol Id</h4>
    <p>The protocol id is a 6-bit (0-63) number that specifies the used application protocol.</p>

    <h4>Command (Cmd)</h4>
    <p>The use of this 3 bits is protocol specific.</p>

    <h4>Length</h4>
    <p>CAN-FD supports data lengths of 0 - 8, 12, 16, 20, 24, 32, 48 or 64 bytes while MiniBus supports 0 - 64 bytes.</p>
    <p>The length field specifies the number of padding bytes to stuff the MiniBus packet length to a CAN-FD frame length.</p>

    <h5>Padding</h5>
    
    <p>CAN-Bus bit stuffing within the padding bytes must be avoided. 170 (AAh / 10101010b) should be used as a padding value.</p>

</document-page>

<document-page>
    <h2>Application Layer</h2>
    <img src="architecture.png" width="100%">

    <h3>Application Header</h3>
    <table>
        <tr>
            <th>Byte</th>
            <th>Content</th>
            <th>Description</th>
        </tr>
        <tr>
            <td>0 - 3</td>
            <td>CRC 32</td>
            <td>CRC of the application image</td>
        </tr>
        <tr>
            <td>4 - 7</td>
            <td>Application Size</td>
            <td>Size of the application image</td>
        </tr>
        <tr>
            <td>8</td>
            <td>Major Application Revision</td>
            <td>Revision of the application</td>
        </tr>
        <tr>
            <td>9</td>
            <td>Minor Application Revision</td>
            <td>Revision of the application</td>
        </tr>
        <tr>
            <td>10-69</td>
            <td>Application Name</td>
            <td>NULL terminated string. In case of 60 characters, NULL can be omitted</td>
        </tr>
        <tr>
            <td>70-73</td>
            <td>Application Main Address</td>
            <td>Application main function entry point address</td>
        </tr>
        <tr>
            <td>74-77</td>
            <td>Application Data Received Address</td>
            <td>Application data received function entry point address</td>
        </tr>
    </table>
    <p>All multi-byte values are stored in little-endian (MSB first) order.</p>

    <h3>Administration Mode</h3>
    <p>The administration mode is a privileged mode that must be entered to perform system critical configuration changes on a device.</p>
    <p>The administration mode can be activated by sending the “Enter Administration Mode” instruction or pressing and holding the administration button on the device for more then 3 sekunds.</p>

    <p>Entering the administration mode will trigger a "System Information" message.</p>
</document-page>

<document-page>
    <h3>Application Control</h3>

    <h4>Starting the application</h4>
    <p>The application will only start if the application CRC is valid.</p> 
    
    <h4>Application Autostart Disabled</h4>
    <p>TBD</p>
    
    <h4>Application Autostart Enabled</h4>
    <p>The device will run the application automatically as soon as the device is powerd-on.</p>
    <p>In case a device reset is triggered due to a watchdog timeout, division-by-zero error, or similar autostart will be automatically disabled.</p>

    <h4>Stopping the application</h4>
    <p>TBD</p>
</document-page>

<document-page>
    <h3>Application Layer Protocol Overview</h3>
    <p>The application layer defines protocols for handling different types of Applications.</p>
    <table>
        <tr>
          <th>Id</th>
          <th>Protocol</th>
          <th>Description</th>
        </tr>
        <tr>
            <td>0</td>
            <td>Device Management Protocol</td>
            <td>The Device Management Protocol provides a basic set of instructions to manage basic device function and to transfer software (Bootloader) and data (File System) to or from the device.</td>
        </tr>
        <tr>
            <td>1</td>
            <td>Message Log Protocol</td>
            <td>Allows to send text based messages from the device to e.g. a logging server.</td>
        </tr>
        <tr>
            <td>2</td>
            <td>File Transfer Protocol </td>
            <td>Allows to access the file system of the device.</td>
        </tr>
        <tr>
            <td>3-7</td>
            <td>Reserved for Kernel</td>
            <td></td>
        </tr>
        <tr>
            <td>8</td>
            <td>Trigger System Protocol</td>
            <td></td>
        </tr>
        <tr>
            <td>9</td>
            <td>Event System Protocol</td>
            <td>The Event System Protocol is used to trigger and report actions on a device.</td>
        </tr>
        <tr>
            <td>10</td>
            <td>State System Protocol</td>
            <td></td>
        </tr>
        <tr>
            <td>11</td>
            <td>Value System Protocol</td>
            <td></td>
        </tr>
        <tr>
            <td>12</td>
            <td>Serial Bridge Protocol</td>
            <td>Allowes serial comunication over the BUS</td>
        </tr>
        <tr>
            <td>13-62</td>
            <td>Reserved</td>
            <td></td>
        </tr>
        <tr>
            <td>63</td>
            <td>Protocol No. extension</td>
            <td>Additional 8bits (following Byte) are added to the Protocol No. size.</td>
        </tr>
    </table>  
    <h3>Protocol Conventions</h3>
    <p>Every application protocol should follow the following conventions if possible:</p>
    <p>TBD</p>
</document-page>

<document-page>
    <h3>Device Management Protocol (ID 0x00)</h3>
    <p>The device management functionality must be completely implemented on all devices.</p>
    <h4>Commands</h4>
    <li>0x00 – Device to Host Communication</li>
    <li>0x01 – Host to Device Communication</li>

    <h4>Instruction List</h4>
    <table>
        <tr>
          <th>Id</th>
          <th>Instruction</th>
          <th>Payload</th>
          <th>Response</th>
        </tr>
        <tr>
            <td>0x00</td>
            <td>Heartbeat</td>
            <td>Status</td>
            <td>-</td>
        </tr>
        <tr>
            <td>0x01</td>
            <td>System Information </td>
            <td>System Information </td>
            <td>-</td>
        </tr>
        <tr>
            <td>0x02</td>
            <td>Hardware Name</td>
            <td>String</td>
            <td>-</td>
        </tr>
        <tr>
            <td>0x03</td>
            <td>Application Name</td>
            <td>String</td>
            <td>-</td>
        </tr>
        <tr>
            <td>0x04</td>
            <td>Device Name</td>
            <td>String</td>
            <td>-</td>
        </tr>
        <tr>
            <td>0x05</td>
            <td>Heartbeat request</td>
            <td>Empty</td>
            <td>Heartbeat</td>
        </tr>
        <tr>
            <td>0x06</td>
            <td>System Information Request</td>
            <td>Empty</td>
            <td>System Info +
                Hardware Name +
                Application Name +
                Device Name</td>
        </tr>
        <tr>
            <td>0x07</td>
            <td>Heartbeat Settings*</td>
            <td>Heartbeat parameter</td>
            <td>-</td>
        </tr>
        <tr>
            <td>0x08</td>
            <td>Write Control</td>
            <td>Control Byte</td>
            <td>-</td>
        </tr>
        <tr>
            <td>0x09</td>
            <td>Set Control</td>
            <td>Control Byte</td>
            <td>-</td>
        </tr>
        <tr>
            <td>0x0A</td>
            <td>Clear Control</td>
            <td>Control Byte</td>
            <td>-</td>
        </tr>
        <tr>
            <td>0x0B</td>
            <td>Enter Administration Mode</td>
            <td>Key</td>
            <td>-</td>
        </tr>
        <tr>
            <td>0x0C</td>
            <td>Exit Administration Mode</td>
            <td>-</td>
            <td>-</td>
        </tr>
        <tr>
            <td>0x0D</td>
            <td>Set Device Name*</td>
            <td>New Device Name</td>
            <td>-</td>
        </tr>
        <tr>
            <td>0x0E</td>
            <td>Set Address*</td>
            <td>New Address</td>
            <td>-</td>
        </tr>
        <tr>
            <td>0x0F</td>
            <td>Set Administration Key*</td>
            <td>New Key</td>
            <td>Heartbeat + Warning in case of invalid key</td>
        </tr>
        <tr>
            <td colspan="4"></td>
        </tr>
        <tr>
            <td>0xF0</td>
            <td>Diagnostics Request</td>
            <td>Empty</td>
            <td>Diagnostics Report</td>
        </tr>
        <tr>
            <td>0xF1</td>
            <td>Diagnostics Report</td>
            <td>Diagnostics Report</td>
            <td>Empty</td>
        </tr>
        <tr>
            <td colspan="4"></td>
        </tr>

        <tr>
            <td>0xF8</td>
            <td>EEPROM Read Request</td>
            <td>EEPROM Offset</td>
            <td>EEPROM Report</td>
        </tr>

        <tr>
            <td>0xF9</td>
            <td>EEPROM Read Report</td>
            <td>EEPROM Data</td>
            <td>-</td>
        </tr>

        <tr>
            <td>0xFA</td>
            <td>Echo</td>
            <td>Echo Data</td>
            <td>Echo</td>
        </tr>
        <tr>
            <td>0xFB</td>
            <td>Reboot</td>
            <td>Empty</td>
            <td></td>
        </tr>
        <tr>
            <td>0xFC</td>
            <td>Erase App*</td>
            <td>Empty</td>
            <td></td>
        </tr>
        <tr>
            <td>0xFD</td>
            <td>Erase App Response*</td>
            <td>Empty</td>
            <td></td>
        </tr>
        <tr>
            <td>0xFE</td>
            <td>Bootload*</td>
            <td>Address + Data</td>
            <td>Bootload Response</td>
        </tr>
        <tr>
            <td>0xFF</td>
            <td>Bootload Response*</td>
            <td>Address + Data Size</td>
            <td>-</td>
        </tr>
    </table>  
    <p>*) The device must be in administration mode to execute these instructions.</p>
</document-page>

<document-page>
    <h4>Heartbeat - 0 (00h)</h4>
    <p>A heartbeat messages will be sent periodically to signal the devices presence on the BUS. The Heartbeat message contains the Status.</p>

    <table>
        <tr>
            <th>Index</th>
            <th>Data</th>
            <th>Data Type</th>
            <th>Size</th>
        </tr>
        <tr>
            <td>0-3</td>
            <td>Status</td>
            <td>32-Bit Integer</td>
            <td>4 Byte</td>
        </tr>
    </table>

    <h4>System Information - 1 (01h)</h4> 
    <table>
        <tr>
            <th>Index</th>
            <th>Data</th>
            <th>Data Type</th>
            <th>Size</th>
        </tr>
        <tr>
            <td>0-3</td>
            <td>Status</td>
            <td>32-Bit Integer</td>
            <td>4 Byte</td>
        </tr>
        <tr>
            <td>4-5</td>
            <td>Hardware Version</td>
            <td>Integer (Major Byte, Minor Byte)</td>
            <td>2 Byte</td>
        </tr>
        <tr>
            <td>6-7</td>
            <td>Kernel Version</td>
            <td>Integer (Major Byte, Minor Byte)</td>
            <td>2 Byte</td>
        </tr>
        <tr>
            <td>8-9</td>
            <td>Heartbeat Interval</td>
            <td>Integer</td>
            <td>2 Byte</td>
        </tr>
        <tr>
            <td>10-11</td>
            <td>Extended Heartbeat Interval</td>
            <td>Integer</td>
            <td>2 Byte</td>
        </tr>
        <tr>
            <td>12-15</td>
            <td>App CRC</td>
            <td>32-Bit Integer</td>
            <td>4 Byte</td>
        </tr>
        <tr>
            <td>16-19</td>
            <td>App Start Address</td>
            <td>32-Bit Intege</td>
            <td>4 Byte</td>
        </tr>
        <tr>
            <td>20-23</td>
            <td>Device Id</td>
            <td>32-Bit Intege</td>
            <td>4 Byte</td>
        </tr>
        <tr>
            <td>24-27</td>
            <td>Device Serial Number Word 0</td>
            <td>32-Bit Intege</td>
            <td>4 Byte</td>
        </tr>
        <tr>
            <td>28-21</td>
            <td>Device Serial Number Word 1</td>
            <td>32-Bit Intege</td>
            <td>4 Byte</td>
        </tr>
        <tr>
            <td>32-35</td>
            <td>Device Serial Number Word 2</td>
            <td>32-Bit Intege</td>
            <td>4 Byte</td>
        </tr>
        <tr>
            <td>36-39</td>
            <td>Device Serial Number Word 3</td>
            <td>32-Bit Intege</td>
            <td>4 Byte</td>
        </tr>
    </table>
</document-page>

<document-page>
    <h4>Hardware Name / Application Name / Device Name (0x02 / 0x03 / 0x04)</h4>
    <p>The name is encoded as ASCII string. The length is limited to 60 characters.</p>
    <p>The Name is not NULL terminated.</p>

    <h4 id="SystemInformationRequest(0x06)">System Information Request (0x06)</h4>
    <p>The System Information request will trigger a Extended Heartbeat Package.</p>

    <h4>Heartbeat Settings (0x08)</h4>
    <p>The Heartbeat Settings define the interval Heartbeat messages are sent.</p>
    <table>
        <tr>
          <th>Data</th>
          <th>Description</th>
          <th>Data Type</th>
          <th>Size</th>
        </tr>
        <tr>
            <td>Heartbeat Interval</td>
            <td>Time in 1 second steps, 0 = off</td>
            <td>16-Bit Integer</td>
            <td>2 Byte</td>
        </tr>
        <tr>
            <td>Extended Heartbeat Interval </td>
            <td>Time in 10 second steps, 0 = off</td>
            <td>16-Bit Integer)</td>
            <td>2 Byte</td>
        </tr>
    </table>
</document-page>

<document-page>
    <h4>Messages</h4>
    <h5>Status</h5>

    <table>
        <tr>
            <th>Bit</th>
            <th>31</th>
            <th>30</th>
            <th>29</th>
            <th>28</th>
            <th>27</th>
            <th>26</th>
            <th>25</th>
            <th>24</th>
        </tr>
        <tr>
            <td></td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>    
        </tr>
        <tr><td style="border: none;"></td></tr>
        <tr>
            <th>Bit</th>
            <th>23</th>
            <th>22</th>
            <th>21</th>
            <th>20</th>
            <th>19</th>
            <th>18</th>
            <th>17</th>
            <th>16</th>
        </tr>
        <tr>
            <td></td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>    
        </tr>
        <tr><td style="border: none;"></td></tr>
        <tr>
            <th>Bit</th>
            <th>15</th>
            <th>14</th>
            <th>13</th>
            <th>12</th>
            <th>11</th>
            <th>10</th>
            <th>9</th>
            <th>8</th>
        </tr>
        <tr><td style="border: none;"></td></tr>
        <tr>
            <td></td>
            <td>Application Error</td>
            <td>-</td>
            <td>RX Buffer Overrun</td>
            <td>TX Message Overrun</td>
            <td>TX Buffer Overrun</td>
            <td>Watchdog Error</td>
            <td>Watchdog Warning</td>
            <td>System Error</td>    
        </tr>

        <tr><td style="border: none;"></td></tr>
        <tr>
            <th>Bit</th>
            <th>7</th>
            <th>6</th>
            <th>5</th>
            <th>4</th>
            <th>3</th>
            <th>2</th>
            <th>1</th>
            <th>0</th>
        </tr>
        <tr>
            <td></td>
            <td>-</td>
            <td>Message Log Enabled</td>
            <td>Administration Mode Flag</td>
            <td>Identify Flag</td>
            <td>LEDs Enabled</td>
            <td>Run App on startup</td>
            <td>App CRC Error</td>
            <td>App Running</td>    
        </tr>
    </table>

    <h5>Control</h5>

    <table>
        <tr>
            <th>Bit</th>
            <th>31</th>
            <th>30</th>
            <th>29</th>
            <th>28</th>
            <th>27</th>
            <th>26</th>
            <th>25</th>
            <th>24</th>
        </tr>
        <tr>
            <td></td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>    
        </tr>
        <tr><td style="border: none;"></td></tr>
        <tr>
            <th>Bit</th>
            <th>23</th>
            <th>22</th>
            <th>21</th>
            <th>20</th>
            <th>19</th>
            <th>18</th>
            <th>17</th>
            <th>16</th>
        </tr>
        <tr>
            <td></td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>    
        </tr>
        <tr><td style="border: none;"></td></tr>
        <tr>
            <th>Bit</th>
            <th>15</th>
            <th>14</th>
            <th>13</th>
            <th>12</th>
            <th>11</th>
            <th>10</th>
            <th>9</th>
            <th>8</th>
        </tr>
        <tr>
            <td></td>
            <td>Clear Application Error</td>
            <td>-</td>
            <td>Clear Rx Buffer Overrun</td>
            <td>Clear Tx Message Overrun</td>
            <td>Clear Tx Buffer Overrun</td>
            <td>Clear Watchdog Error</td>
            <td>Clear Watchdog Warning</td>
            <td>Clear System Error</td>    
        </tr>
        <tr><td style="border: none;"></td></tr>
        <tr>
            <th>Bit</th>
            <th>7</th>
            <th>6</th>
            <th>5</th>
            <th>4</th>
            <th>3</th>
            <th>2</th>
            <th>1</th>
            <th>0</th>
        </tr>
        <tr>
            <td></td>
            <td>-</td>
            <td>Message Log Enabled</td>
            <td>-</td>
            <td>Identify Enabled</td>
            <td>LEDs Enabled</td>
            <td>Run App on startup</td>
            <td>Check App CRC</td>
            <td>Run App</td>    
        </tr>
    </table>
</document-page>

<document-page>
    <h4>Diagnostics Request (0xF0)</h4>
    <h4>Diagnostics Report (0xF1)</h4>
    <table>
        <tr>
          <th>Data</th>
          <th>Data Type</th>
          <th>Size</th>
        </tr>
        <tr>
            <td>Bus Error Counter</td>
            <td>24-Bit Integer</td>
            <td>3 Byte</td>
        </tr>
        <tr>
            <td>Last Error Code</td>
            <td>Byte</td>
            <td>1 Byte</td>
        </tr>
        <tr>
            <td>App Time (Avg [us])</td>
            <td>32-Bit Integer</td>
            <td>4 Byte</td>
        </tr>
        <tr>
            <td>App Time (Min [us])</td>
            <td>32-Bit Integer</td>
            <td>4 Byte</td>
        </tr>
        <tr>
            <td>App Time (Max [us])</td>
            <td>32-Bit Integer</td>
            <td>4 Byte</td>
        </tr>
    </table>

    <h4>EEPROM Read Request (0xF8)</h4>

    <h4>EEPROM Read Report (0xF9)</h4>


    <h4>Echo (0xFA)</h4>
    <p>The Echo Instruction will return a received payload back to the sender.</p>
    <p>The intended use case for this instruction is to test the connection between devices.</p>

    <h4>Reboot* (0xFB)</h4>
    <p>This instruction will shutdown the app and restart the device.</p>
</document-page>

<document-page>
    <h4>Erase App* (0xFC)</h4>
    <p>This command will stop the execution of the application and erase the application section in the device memory.</p>

    <h4>Erase App Response* (0xFD)</h4>
    <p>This instruction will be sent by the device after the erasing process is completed.</p>

    <h4>Bootload Write* (0xFE)</h4>
    <p>This istruction code is used to send the application image to the device.</p>
    <table>
        <tr>
          <th>Data</th>
          <th>Data Type</th>
          <th>Size</th>
        </tr>
        <tr>
            <td>Address Offset</td>
            <td>32-Bit Integer</td>
            <td>4 Byte</td>
        </tr>
        <tr>
            <td>Data</td>
            <td>n Byte</td>
            <td>0 - 2 Byte</td>
        </tr>
    </table>


    <h4>Bootload Response* (0xFF)</h4>
    <p>Once a Bootload Write instruction is completed, theis reponce will be sent.</p>
    <table>
        <tr>
          <th>Data</th>
          <th>Data Type</th>
          <th>Size</th>
        </tr>
        <tr>
            <td>Address Offset</td>
            <td>32-Bit Integer</td>
            <td>4 Byte</td>
        </tr>
        <tr>
            <td>Number of bytes written</td>
            <td>Byte</td>
            <td>1 Byte</td>
        </tr>
    </table>
</document-page>

<document-page>
    <h3>Message Log Protocol</h3>
    <p>The message log protocol allows to send text messages for logging and diagnostic purposes from the device to a host.</p>
    <p>Messages must be encoded as ANSI string.</p>
    <p>The message length is limited to 60 characters.</p>
    <p><b>Protocol Id:</b> 1 (1h)</p>
    
    <h4>Information Flow</h4>
    <p>This protocol only generates outbound traffic from a device. Inbound traffic is ignored. </p>

    <h4>Commands</h4>
    <li>0x00 – System Message</li>
    <li>0x01 – System Warning Message</li>
    <li>0x02 – System Error Message</li>
    <li>0x03 – Reserved</li>
    <li>0x04 – Application Message</li>
    <li>0x05 – Application Warning Message</li>
    <li>0x06 – Application Error Message</li>
    <li>0x07 – Reserved</li>

    <h4>Payload</h4>
    <p>Byte 0 - 3 is the system tick time. This value represents the number of milliseconds since the device started.</p>
    <p>Byte 4 - 7 is reserved. Those bytes must be set to 0.</p>
    <p>Byte 8 - 63 can be used for the message.</p>
    <table style="table-layout : fixed; border: none;">
        <tr>
            <th>Byte</th>
            <th>0</th>
            <th>1</th>
            <th>2</th>
            <th>3</th>
            <th>4</th>
            <th>5</th>
            <th>6</th>
            <th>7</th>
            <th colspan="6">8 - 63</th>
        </tr>
        <tr>
            <th>Data</th>
            <td colspan="4" >System Tick Time</td>
            <td colspan="4" >Reserved</td>
            <td colspan="6">Message</td>
        </tr>
    </table>

</document-page>

<document-page>
    <h3>File Transfer Protocol</h3>
    <p>The file transfer protocol allows access to the file system on the device.</p>
    <p><b>Protocol Id:</b> 2 (2h)</p>

    <h4>Information Flow</h4>
    <p>This protocol generates outbound traffic from the device on request.</p>

    <h4>Commands</h4>
    
    <li>0x00 – Host to Device Communication</li>
    <li>0x01 – Device to Host Communication</li>
    <li>0x02 – Reserved</li>
    <li>0x03 – Reserved</li>
    <li>0x04 – Data Transfer from Device</li>
    <li>0x05 – From Device Ack </li>
    <li>0x06 – Data Transfer to Device</li>
    <li>0x07 – To Device  Ack</li>

    <h5>Command (0x00)</h5>
    <table>
        <tr>
            <th>Code</th>
            <th>Name</th>
            <th>Payload</th>
            <th>Response</th>
            <th>Description</th>
        </tr>
        <tr>
            <td>0x00</td>
            <td>List content</td>
            <td>Path</td>
            <td>File Info</td>
            <td></td>
        </tr>
        <tr>
            <td>0x01</td>
            <td>Get space Information</td>
            <td>Path</td>
            <td></td>
            <td>Not implemented</td>
        </tr>
        <tr>
            <td>0x02</td>
            <td>Get File Information</td>
            <td>Path</td>
            <td></td>
            <td>Not implemented</td>
        </tr></td>
        </tr>

        <tr><td style="border: none;"></td></tr>
        <tr>
            <td>0x08</td>
            <td>Make File</td>
            <td>Path</td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td>0x09</td>
            <td>Delete File</td>
            <td>Path</td>
            <td></td>
            <td></td>
        </tr>
        <tr><td style="border: none;"></td></tr>
        <tr>
            <td>0x20</td>
            <td>Start File Read</td>
            <td>Path</td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td>0x21</td>
            <td>End File Read</td>
            <td>Path</td>
            <td></td>
            <td></td>
        </tr>
        <tr><td style="border: none;"></td></tr>
        <tr>
            <td>0x30</td>
            <td>Start File Write</td>
            <td>Path</td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td>0x31</td>
            <td>End File Write</td>
            <td>Path</td>
            <td></td>
            <td></td>
        </tr>
    </table>
</document-page>

<document-page>
    <h5>Response (0x01)</h5>
    <table>
        <tr>
            <th>Code</th>
            <th>Name</th>
            <th>Payload</th>
            <th>Description</th>
        </tr>
        <tr>
            <td>0x00</td>
            <td>File Info</td>
            <td>File Info</td>
            <td></td>
        </tr>
        <tr><td style="border: none;"></td></tr>
        <tr>
            <td>0x20</td>
            <td>Start File Read Acknowledgment</td>
            <td>Path</td>
            <td></td>
        </tr>
        <tr><td style="border: none;"></td></tr>
        <tr>
            <td>0x30</td>
            <td>Start File Write Acknowledgment</td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td>0x31</td>
            <td>Complete File Write Acknowledgment</td>
            <td></td>
            <td></td>
        </tr>
    </table>
    <p></p>
    <img src="FileTransferProtocol.png" alt="File Transfer Protocol" style="width:100%;">

</document-page>

<document-page>
    <h5>File Info Response</h5>
    <table>
        <tr>
            <th colspan="9">Byte</th>
        </tr>
        <tr>
            <th>0</th>
            <th>1</th>
            <th>2</th>
            <th>3</th>
            <th>4</th>
            <th>5</th>
            <th>6</th>
            <th>7-57</th>
            <th>58-62</th>
        </tr>
        <tr>
            <td>Code (0x00)</td>
            <td>Status</td>
            <td>Type</td>
            <td colspan="4">File Size</td>
            <td>Path</td>
            <td>Reserved</td>
        </tr>
    </table>

    <h5>Status</h5>
    <table>
        <tr>
            <th>Code</th>
            <th>Name</th>
            <th>Description</th>
        </tr>
        <tr>
            <td>0x00</td>
            <td>ftp_rsps_ok</td>
            <td></td>
        </tr>
        <tr>
            <td>0x01</td>
            <td>ftp_rsps_pathInvalid</td>
            <td></td>
        </tr>
        <tr><td style="border: none;"></td></tr>
        <tr>
            <td>0x20</td>
            <td>ftp_rsps_writeSuccessful</td>
            <td></td>
        </tr>
        <tr>
            <td>0x21</td>
            <td>ftp_rsps_writeCrcError</td>
            <td></td>
        </tr>
        <tr>
            <td>0x22</td>
            <td>ftp_rsps_writeSequencingError</td>
            <td></td>
        </tr>
        <tr><td style="border: none;"></td></tr>
        <tr>
            <td>0x30</td>
            <td>ftp_rsps_readSuccessful</td>
            <td></td>
        </tr>
        <tr>
            <td>0x31</td>
            <td>ftp_rsps_readCrcError</td>
            <td></td>
        </tr>
        <tr>
            <td>0x32</td>
            <td>ftp_rsps_readSequencingError</td>
            <td></td>
        </tr>
    </table>

    <h5>Data Transfer from Device (0x04) / Data Transfer to Device (0x06)</h5>
    <table>
        <tr>
            <th colspan="5">Byte</th>
        </tr>
        <tr>
            <th>0</th>
            <th>1</th>
            <th>2</th>
            <th>3</th>
            <th>4-n</th>
        </tr>
        <tr>
            <td colspan="4">Data Offset</td>
            <td>Data</td>
        </tr>
    </table>

    <h5>From Device Acknowledgment (0x05) / To Device Acknowledgment (0x07)</h5>
    <table>
        <tr>
            <th colspan="1">Byte</th>
        </tr>
        <tr>
            <th>0</th>
        </tr>
        <tr>
            <td>Status</td>
        </tr>
    </table>
</document-page>

<document-page>
    <h3>Trigger System Protocol</h3>
    <p>The trigger system protocol allows to trigger an action on a device.</p>
    <p>A device can emit triggers, called a trigger signal, and consume triggers, called a trigger slot.</p>
    <p><b>Protocol Id:</b> 8 (8h)</p>

    <h4>Information Flow</h4>
    <p>This protocol accepts inbound traffic and generates outbound traffic.</p>

    <h4>Commands </h4>
    <li>0x00 – Trigger</li>
    <li>0x01 – Reserved</li>
    <li>0x02 – Reserved</li>
    <li>0x03 – Reserved</li>
    <li>0x04 – Trigger Signal Information Report</li>
    <li>0x05 – Trigger Slot Information Report</li>
    <li>0x06 – Trigger Signal Information Request</li>
    <li>0x07 – Trigger Slot Information Request</li>

    <h5>Trigger</h5>
    <p>A trigger command holds a list of trigger channels.</p>
    <p>1 to 32 triggers can be sent in one message.</p>
    <table style="table-layout: fixed;">
        <tr>
            <th style="width: 100px;">Byte</th>
            <th>n</th>
            <th>n+1</th>
        </tr>
        <tr>
            <th>Data</th>
            <td colspan="2">Trigger Channel Number</td>
        </tr>
    </table>
</document-page>

<document-page>
    <h5>Trigger Signal Information Request / Trigger Slot Information Request</h5>

    <p>Upon receipt of a information request, the device will respond with a information report.</p>
    <p>The payload of the information request can either contain a list of the requested trigger channel numbers or be left empty.</p>
    <p>In case of an empty payload, a trigger information report for all configured trigger signals or slots will be returned respectively.</p>
    
    <table style="table-layout: fixed;">
        <tr>
            <th style="width: 100px;">Byte</th>
            <th>n</th>
            <th>n+1</th>
        </tr>
        <tr>
            <th>Data</th>
            <td colspan="2">Trigger Channel Number</td>
        </tr>
    </table>

    <h5>Trigger Signal Information Report</h5>
    <p></p>
    <table style="table-layout: fixed;">
        <tr>
            <th style="width: 100px;">Byte</th>
            <th>0</th>
            <th>1</th>
            <th>2+n</th>
        </tr>
        <tr>
            <th>Data</th>
            <td colspan="2">Trigger Channel Number</td>
            <td>Channel Description</td>
        </tr>
    </table>

    <h5>Trigger Slot Information Report</h5>
    <p></p>
    <table style="table-layout: fixed;">
        <tr>
            <th style="width: 100px;">Byte</th>
            <th>0</th>
            <th>1</th>
            <th>2+n</th>
        </tr>
        <tr>
            <th>Data</th>
            <td colspan="2">Trigger Channel Number</td>
            <td>Channel Description</td>
        </tr>
    </table>
</document-page>

<document-page>
    <h3>Event System Protocol</h3>
    <p>The event system protocol allows to enable an action for a defined time on a device.</p>
    <p><b>Protocol Id:</b> 9 (9h)</p>

    <h4>Information Flow</h4>
    <p>This protocol accepts inbound traffic and generates outbound traffic.</p>

    <h4>Commands </h4>
    <li>0x00 – Event</li>
    <li>0x01 – Reserved</li>
    <li>0x02 – Reserved</li>
    <li>0x03 – Reserved</li>
    <li>0x04 – Event Signal Information Report</li>
    <li>0x05 – Event Slot Information Report</li>
    <li>0x06 – Event Signal Information Request</li>
    <li>0x07 – Event Slot Information Request</li>

    <h5>Event Slot</h5>
    <p></p>
    <table style="table-layout: fixed;">
        <tr>
            <th style="width: 100px;">Byte</th>
            <th>n</th>
            <th>n+1</th>
        </tr>
        <tr>
            <th>Data</th>
            <td colspan="2">Event Channel Number</td>
        </tr>
    </table>
</document-page>

<document-page>
    <h5>Event Signal Information Request / Event Slot Information Request</h5>

    <p>Upon receipt of a information request, the device will respond with a information report.</p>
    <p>The payload of the information request can either contain a list of the requested event channel numbers or be left empty.</p>
    <p>In case of an empty payload, a event information report for all configured event signals or slots will be returned respectively.</p>
    
    <table style="table-layout: fixed;">
        <tr>
            <th style="width: 100px;">Byte</th>
            <th>n</th>
            <th>n+1</th>
        </tr>
        <tr>
            <th>Data</th>
            <td colspan="2">Event Channel Number</td>
        </tr>
    </table>
    <h5>Event Signal Information Report</h5>
    <p></p>
    <table style="table-layout: fixed;">
        <tr>
            <th style="width: 100px;">Byte</th>
            <th>0</th>
            <th>1</th>
            <th>2</th>
            <th>3</th>
            <th>4-n</th>
        </tr>
        <tr>
            <th>Data</th>
            <td colspan="2">Event Channel Number</td>
            <td colspan="2" >Interval</td>
            <td>Channel Name</td>
        </tr>
    </table>
  
    <h5>Event Slot Information Report</h5>
    <p></p>
    <table style="table-layout: fixed;">
        <tr>
            <th style="width: 100px;">Byte</th>
            <th>0</th>
            <th>1</th>
            <th>2</th>
            <th>3</th>
            <th>4-n</th>
        </tr>
        <tr>
            <th>Data</th>
            <td colspan="2">Event Channel Number</td>
            <td colspan="2" >Timeout</td>
            <td>Channel Name</td>
        </tr>
    </table>
</document-page>

<document-page>
    <h3>State System Protocol</h3>
    <p>The state system protocol allows the distribution of a device state on the system.</p>
    <p><b>Protocol Id:</b> 10 (Ah)</p>

    <h4>Information Flow</h4>
    <p>This protocol accepts inbound traffic and generates outbound traffic.</p>

    <h4>Commands </h4>
    <li>0x00 – State Report</li>
    <li>0x01 – State Request</li>
    <li>0x02 – Reserved</li>
    <li>0x03 – Reserved</li>
    <li>0x04 – State Signal Information Report</li>
    <li>0x05 – State Slot Information Report</li>
    <li>0x06 – State Signal Information Request</li>
    <li>0x07 – State Slot Information Request</li>

    <h5>State Report</h5>
    <table style="table-layout: fixed;">
        <tr>
            <th style="width: 100px;">Byte</th>
            <th>n</th>
            <th>n+1</th>
            <th>n+2</th>
        </tr>
        <tr>
            <th>Data</th>
            <td colspan="2">State Channel Number</td>
            <td>State Code</td>
        </tr>
    </table>

    <h6>State Code</h6>
    <table>
        <tr>
            <th>Code</th>
            <th>Name</th>
            <th>Description</th>
        </tr>
        <tr>
            <td>0</td>
            <td>Off</td>
            <td></td>
        </tr>
        <tr>
            <td>1</td>
            <td>On</td>
            <td></td>
        </tr>
        <tr>
            <td>2</td>
            <td>Transitioning</td>
            <td>State is transitioning from On to Off</td>
        </tr>
        <tr>
            <td>3</td>
            <td>Undefined / Error</td>
            <td>State is unclear or error</td>
        </tr>
        <tr>
            <td>4-255</td>
            <td>Reserved</td>
            <td></td>
        </tr>
    </table>
</document-page>

<document-page>
    <h5>State Request / State Signal Information Request / State Slot Information Request</h5>

    <p>Upon receipt of a request, the device will respond with a report.</p>
    <p>The payload of the request can either contain a list of the requested event channel numbers or be left empty.</p>
    <p>In case of an empty payload, a report for all configured signals or slots will be returned respectively.</p>
    
    <table style="table-layout: fixed;">
        <tr>
            <th style="width: 100px;">Byte</th>
            <th>n</th>
            <th>n+1</th>
        </tr>
        <tr>
            <th>Data</th>
            <td colspan="2">State Channel Number</td>
        </tr>
    </table>
    <h5>State Signal Information Report</h5>
    <p></p>
    <table style="table-layout: fixed;">
        <tr>
            <th style="width: 100px;">Byte</th>
            <th>0</th>
            <th>1</th>
            <th>2+n</th>
        </tr>
        <tr>
            <th>Data</th>
            <td colspan="2">State Channel Number</td>
            <td>Channel Name</td>
        </tr>
    </table>
  
    <h5>State Slot Information Report</h5>
    <p></p>
    <table style="table-layout: fixed;">
        <tr>
            <th style="width: 100px;">Byte</th>
            <th>0</th>
            <th>1</th>
            <th>2+n</th>
        </tr>
        <tr>
            <th>Data</th>
            <td colspan="2">State Channel Number</td>
            <td>Channel Name</td>
        </tr>
    </table>
</document-page>

<document-page>
    <h3>Value System Protocol</h3>

    <p>The value system protocol allows the distribution of a device value on the system.</p>
    <p><b>Protocol Id:</b> 11 (Bh)</p>

    <h4>Information Flow</h4>
    <p>This protocol accepts inbound traffic and generates outbound traffic.</p>

    <h4>Commands </h4>
    <li>0x00 – Value Report</li>
    <li>0x01 – Value Request</li>
    <li>0x02 – Value Command</li>
    <li>0x03 – Reserved</li>
    <li>0x04 – Value Signal Information Report</li>
    <li>0x05 – Value Slot Information Report</li>
    <li>0x06 – Value Signal Information Request</li>
    <li>0x07 – Value Slot Information Request</li>

    <h5>Value Report</h5>
    <table style="table-layout: fixed;">
        <tr>
            <th style="width: 100px;">Byte</th>
            <th>0</th>
            <th>1</th>
            <th>2</th>
            <th>3</th>
            <th>4</th>
            <th>5</th>
        </tr>
        <tr>
            <th>Data</th>
            <td colspan="2">Value Channel Number</td>
            <td colspan="4">Value</td>
        </tr>
    </table>

    <h5>Value Command</h5>
    <table style="table-layout: fixed;">
        <tr>
            <th style="width: 100px;">Byte</th>
            <th>0</th>
            <th>1</th>
            <th>2</th>
            <th>3</th>
            <th>4</th>
            <th>5</th>
            <th>6</th>
        </tr>
        <tr>
            <th>Data</th>
            <td colspan="2">Value Channel Number</td>
            <td>Operation Id</td>
            <td colspan="4">Value</td>
        </tr>
    </table>
</document-page>

<document-page>
    <h5>Operation</h5>
    <table>
        <tr>
            <th>Id</th>
            <th>Description</th>
            <th>Limit enforcement</th>
            <th>Datatype</th>
        </tr>
        <tr>
            <td>0x00</td>
            <td>Set value to minimum</td>
            <td>-</td>
            <td>-</td>
        </tr>
        <tr>
            <td>0x01</td>
            <td>Set value to maximum</td>
            <td>-</td>
            <td>-</td>
        </tr>
        <tr>
            <td>0x02</td>
            <td>Invert / Complement</td>
            <td>-</td>
            <td>-</td>
        </tr>

        <tr>
            <th colspan="4"></th>
        </tr>
        <tr>
            <th colspan="4"></th>
        </tr>
        <tr>
            <td>0x10</td>
            <td>Set value</td>
            <td>Reject</td>
            <td>Long</td>
        </tr>
        <tr>
            <td>0x11</td>
            <td>Set value</td>
            <td>Clamp</td>
            <td>Long</td>
        </tr>
        <tr>
            <th colspan="4"></th>
        </tr>
        <tr>
            <td>0x20</td>
            <td>Add value</td>
            <td>Reject</td>
            <td>Long</td>
        </tr>
        <tr>
            <td>0x21</td>
            <td>Add value</td>
            <td>Clamp</td>
            <td>Long</td>
        </tr>
        <tr>
            <th colspan="4"></th>
        </tr>
        <tr>
            <td>0x30</td>
            <td>Subtract value</td>
            <td>Reject</td>
            <td>Long</td>
        </tr>
        <tr>
            <td>0x31</td>
            <td>Subtract value</td>
            <td>Clamp</td>
            <td>Long</td>
        </tr>
       
        <tr>
            <th colspan="4"></th>
        </tr>
        <tr>
            <th colspan="4"></th>
        </tr>
        <tr>
            <td>0x40</td>
            <td>Set value</td>
            <td>Reject</td>
            <td>Number</td>
        </tr>
        <tr>
            <td>0x41</td>
            <td>Set value</td>
            <td>Clamp</td>
            <td>Number</td>
        </tr>
        <tr>
            <th colspan="4"></th>
        </tr>
        <tr>
            <td>0x50</td>
            <td>Add  value</td>
            <td>Reject</td>
            <td>Number</td>
        </tr>
        <tr>
            <td>0x51</td>
            <td>Add  value</td>
            <td>Clamp</td>
            <td>Number</td>
        </tr>
    </table>
</document-page>

<document-page>
    <h5>Value Signal Information Request / Value Slot Information Request</h5>

    <p>Upon receipt of a information request, the device will respond with a information report.</p>
    <p>The payload of the information request can either contain a list of the requested event channel numbers or be left empty.</p>
    <p>In case of an empty payload, a information report for all configured signals or slots will be returned respectively.</p>
    
    <table style="table-layout: fixed;">
        <tr>
            <th style="width: 100px;">Byte</th>
            <th>n</th>
            <th>n+1</th>
        </tr>
        <tr>
            <th>Data</th>
            <td colspan="2">Value Channel Number</td>
        </tr>
    </table>
    <h5>Value Signal Information Report</h5>
    <p></p>
    <table style="table-layout: fixed;">
        <tr>
            <th style="width: 100px;">Byte</th>
            <th>0</th>
            <th>1</th>
            <th>2</th>
            <th>3</th>
            <th>4</th>
            <th>5</th>
            <th>6</th>
            <th>7</th>
            <th>8</th>
            <th>9</th>
            <th>10</th>
            <th>11</th>
            <th>12</th>
            <th>13</th>
            <th>14+n</th>
        </tr>
        <tr>
            <th>Data</th>
            <td colspan="2">Value Channel Number</td>
            <td colspan="2">Interval</td>
            <td>RO</td>
            <td>UoM</td>
            <td colspan="4">Minimum</td>
            <td colspan="4">Maximum</td>
            <td>Channel Name</td>
        </tr>
    </table>
  
    <h5>Value Slot Information Report</h5>
    <p></p>
    <table style="table-layout: fixed;">
        <tr>
            <th style="width: 100px;">Byte</th>
            <th>0</th>
            <th>1</th>
            <th>2</th>
            <th>3</th>
            <th>4</th>
            <th>5</th>
            <th>6+n</th>
        </tr>
        <tr>
            <th>Data</th>
            <td colspan="2">Value Channel Number</td>
            <td colspan="2">Timeout</td>
            <td colspan="2">Unit of Measurement</td>
            <td>Channel Name</td>
        </tr>
    </table>
</document-page>

<document-page>
    <h4>Unit of Measurements</h4>
    <p>For data type definitions, see chapter  "Datatypes"</p>
    <table>
        <tr>
            <th>UoM Code</th>
            <th>Symbol</th>
            <th>Description</th>
            <th>Data Type</th>
            <th>Note</th>
        </tr>
        <tr>
            <td>0x00</td>
            <td></td>
            <td>Generic Long</td>
            <td>Long</td>
            <td></td>
        </tr>
        <tr>
            <td>0x01</td>
            <td></td>
            <td>Generic Number</td>
            <td>Number</td>
            <td></td>
        </tr>
        <tr>
            <td colspan="5"></td>
        </tr>
        <tr>
            <td>0x10</td>
            <td></td>
            <td>Absolute Time</td>
            <td>Long</td>
            <td>Unix time as 32 bit unsigned int</td>
        </tr>
        <tr>
            <td>0x11</td>
            <td></td>
            <td>Time of Day</td>
            <td>Long</td>
            <td>Milliseconds since midnight</td>
        </tr>
        <tr>
            <td>0x12</td>
            <td></td>
            <td>Date</td>
            <td>Long</td>
            <td>tbd</td>
        </tr>
        <tr>
            <td>0x13</td>
            <td>s</td>
            <td>Relative Time</td>
            <td>Number</td>
            <td></td>
        </tr>
        <tr>
            <td>0x14</td>
            <td>°C</td>
            <td>Temperature</td>
            <td>Number</td>
            <td></td>
        </tr>
        <tr>
            <td>0x15</td>
            <td>%</td>
            <td>Rel. Humidity</td>
            <td>Number</td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td>kPa</td>
            <td>Pressure</td>
            <td>Number</td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td>V</td>
            <td>Voltage</td>
            <td>Number</td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td>A</td>
            <td>Current</td>
            <td>Number</td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td>W</td>
            <td>Power</td>
            <td>Number</td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td></td>
            <td>Power Factor</td>
            <td>Number</td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td>Hz</td>
            <td>Frequency</td>
            <td>Number</td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td>kWh</td>
            <td>Energy</td>
            <td>Number</td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td>Ω</td>
            <td>Resistance</td>
            <td>Number</td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td>F</td>
            <td>Capacitance</td>
            <td>Number</td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td>N</td>
            <td>Force</td>
            <td>Number</td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td>kg</td>
            <td>Weight</td>
            <td>Number</td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td>m</td>
            <td>Length</td>
            <td>Number</td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td>m/s</td>
            <td>Speed</td>
            <td>Number</td>
            <td></td>
        </tr>
    </table>
</document-page>

<document-page>
    <h3>Serial Bridge Protocol (ID 0x0C)</h3>
    <h4>Commands </h4>
    <li>0x00 – Data</li>
    <li>0x01 – Reserved</li>
    <li>0x02 – Reserved</li>
    <li>0x03 – Reserved</li>
    <li>0x04 – Port Info Report</li>
    <li>0x05 – Port Info Request</li>
    <li>0x06 – Reserved</li>
    <li>0x07 – Reserved</li>

    <h4>Data (0x00) OLD</h4>
    <table>
        <tr>
            <th colspan="9">Byte</th>
        </tr>
        <tr>
            <th>0</th>
            <th>1</th>
            <th>2</th>
            <th>3</th>
            <th>4</th>
            <th>5</th>
            <th>6</th>
            <th>7</th>
            <th>8-n</th>
        </tr>
        <tr>
            <td colspan="4" >Source Port No</td>
            <td colspan="4" >Destination Port No</td>
            <td>Data</td>
        </tr>
    </table>

    <h4>Data (0x00) </h4>
    <table>
        <tr>
            <th colspan="9">Byte</th>
        </tr>
        <tr>
            <th>0</th>
            <th>1</th>
            <th>2-n</th>

        </tr>
        <tr>
            <td>Port</td>
            <td>Status</td>

            <td>Data</td>
        </tr>
    </table>

    <h4>Port Info Report (0x04)</h4>
    <table>
        <tr>
            <th colspan="2">Byte</th>
        </tr>
        <tr>
            <th>0</th>
            <th>1-n</th>
        </tr>
        <tr>
            <td>Number of Ports</td>
            <td>Port Information</td>
        </tr>
    </table>

    <h5>Port Information</h5>
    <table>

        <tr>
            <th>Code</th>
            <th>Type</th>
            <th>Description</th>
        </tr>
        <tr>
            <td>0x00</td>
            <td>UART (Serial Port)</td>
            <td></td>
        </tr>
        <tr>
            <td>0x01</td>
            <td>I2C</td>
            <td></td>
        </tr>
    </table>

    <h4>Port Info Request (0x05)</h4>
    <p>This command will return a list of available ports. The Data field is empty.</p>
</document-page>


</div>
</body>